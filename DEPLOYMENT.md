# ğŸš€ Cloudflare éƒ¨ç½²æŒ‡å—

## å‰ç½®æ¡ä»¶

1. **Cloudflareè´¦æˆ·**: ç¡®ä¿ä½ æœ‰Cloudflareè´¦æˆ·
2. **Wrangler CLI**: å·²å®‰è£…å¹¶é…ç½®
3. **é¡¹ç›®ä¾èµ–**: ç¡®ä¿æ‰€æœ‰ä¾èµ–å·²å®‰è£…

## éƒ¨ç½²æ­¥éª¤

### 1. ç™»å½•Cloudflare

```bash
wrangler login
```

### 2. åˆ›å»ºå¿…è¦èµ„æº

#### åˆ›å»ºD1æ•°æ®åº“
```bash
npm run db:create
```

#### åˆ›å»ºKVå­˜å‚¨
```bash
npm run kv:create
```

#### åˆ›å»ºR2å­˜å‚¨æ¡¶
```bash
npm run r2:create
npm run r2:create-preview
```

### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
# åˆ›å»ºè¡¨ç»“æ„
npm run db:tables

# åˆ›å»ºç´¢å¼•
npm run db:indexes
```

### 4. éƒ¨ç½²åº”ç”¨

```bash
# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
npm run deploy
```

### 5. éªŒè¯éƒ¨ç½²

éƒ¨ç½²å®Œæˆåï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„URLï¼š
```
https://temp-mail.your-subdomain.workers.dev
```

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
- `TELEGRAM_LOG_ENABLE`: å¯ç”¨Telegramæ—¥å¿—
- `HOURS_TO_DELETE_D1`: æ•°æ®åˆ é™¤æ—¶é—´ï¼ˆå°æ—¶ï¼‰

### å®šæ—¶ä»»åŠ¡
- `0 */4 * * *`: æ¯4å°æ—¶æ‰§è¡Œ
- `0 */5 * * *`: æ¯5å°æ—¶æ‰§è¡Œ

### èµ„æºç»‘å®š
- **D1æ•°æ®åº“**: å­˜å‚¨é‚®ä»¶æ•°æ®
- **KVå­˜å‚¨**: ç¼“å­˜å’Œä¸´æ—¶æ•°æ®
- **R2å­˜å‚¨**: å­˜å‚¨é‚®ä»¶é™„ä»¶

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ„å»ºå¤±è´¥**: æ£€æŸ¥ä¾èµ–æ˜¯å¦æ­£ç¡®å®‰è£…
2. **æ•°æ®åº“è¿æ¥å¤±è´¥**: ç¡®ä¿D1æ•°æ®åº“å·²åˆ›å»º
3. **KVè®¿é—®å¤±è´¥**: æ£€æŸ¥KVå‘½åç©ºé—´é…ç½®
4. **R2ä¸Šä¼ å¤±è´¥**: éªŒè¯R2å­˜å‚¨æ¡¶æƒé™

### è°ƒè¯•å‘½ä»¤

```bash
# æŸ¥çœ‹æ—¥å¿—
npm run tail

# æœ¬åœ°å¼€å‘
npm run dev

# ç±»å‹æ£€æŸ¥
npm run tsc
```

## ç›‘æ§å’Œç»´æŠ¤

1. **æŸ¥çœ‹åº”ç”¨æ—¥å¿—**: ä½¿ç”¨ `wrangler tail`
2. **ç›‘æ§æ€§èƒ½**: åœ¨Cloudflare DashboardæŸ¥çœ‹
3. **æ•°æ®åº“ç®¡ç†**: ä½¿ç”¨D1æ§åˆ¶å°ç®¡ç†æ•°æ®
4. **å­˜å‚¨ç®¡ç†**: é€šè¿‡R2æ§åˆ¶å°ç®¡ç†é™„ä»¶

## è‡ªå®šä¹‰åŸŸå

å¦‚éœ€ä½¿ç”¨è‡ªå®šä¹‰åŸŸåï¼š

1. åœ¨Cloudflare Dashboardæ·»åŠ åŸŸå
2. é…ç½®DNSè®°å½•
3. æ›´æ–° `wrangler.jsonc` ä¸­çš„è·¯ç”±é…ç½®

## å®‰å…¨å»ºè®®

1. **ç¯å¢ƒå˜é‡**: ä½¿ç”¨ `wrangler secret` å­˜å‚¨æ•æ„Ÿä¿¡æ¯
2. **è®¿é—®æ§åˆ¶**: é…ç½®é€‚å½“çš„CORSç­–ç•¥
3. **æ•°æ®æ¸…ç†**: å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
4. **ç›‘æ§**: è®¾ç½®å‘Šè­¦å’Œç›‘æ§

## æ›´æ–°éƒ¨ç½²

```bash
# é‡æ–°éƒ¨ç½²
npm run deploy

# æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
wrangler deployments list
```

## å›æ»š

å¦‚éœ€å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼š

```bash
wrangler rollback
```
